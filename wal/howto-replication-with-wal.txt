pg_createcluster 17 testcluster1
pg_createcluster 17 testcluster2




# primary
/etc/postgresql/17/testcluster1/postgresql.conf

listen_addresses = '*'
wal_level = replica









/etc/postgresql/17/testcluster1/pg_hba.conf
host    replication     replicator             0.0.0.0/0            md5




CREATE ROLE replicator WITH REPLICATION LOGIN PASSWORD 'password';



pg_ctlcluster 17 testcluster1 restart









# secondary

pg_ctlcluster 17 testcluster2 stop
rm -Rf /var/lib/postgresql/17/testcluster2/*


pg_basebackup -h localhost -U replicator -D /var/lib/postgresql/17/testcluster2 -P -R





/etc/postgresql/17/testcluster2/postgresql.conf




