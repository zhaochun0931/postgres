pg_createcluster 17 testcluster1
pg_createcluster 17 testcluster2




# primary
/etc/postgresql/17/testcluster1/postgresql.conf

listen_addresses = '*'
wal_level = replica









/etc/postgresql/17/testcluster1/pg_hba.conf
host    replication     replicator             0.0.0.0/0            md5




CREATE ROLE replicator WITH REPLICATION LOGIN PASSWORD 'password';



pg_ctlcluster 17 testcluster1 restart









# secondary

pg_ctlcluster 17 testcluster2 stop
rm -Rf /var/lib/postgresql/17/testcluster2/*


pg_basebackup -h localhost -p 5433 -U replicator -D /var/lib/postgresql/17/testcluster2 -P -R


-h → host (localhost, or IP).

-p → port of the primary cluster.

-U → replication user (e.g. replicator).

-D → destination data directory (must be empty).

-P → show progress.

-R → creates a standby.signal and configures primary_conninfo automatically.




/etc/postgresql/17/testcluster2/postgresql.conf




